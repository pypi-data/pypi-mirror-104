(this.webpackJsonpsqllineagejs=this.webpackJsonpsqllineagejs||[]).push([[0],{463:function(e,t,n){},739:function(e,t,n){"use strict";n.r(t);var r,a=n(41),i=n(7),c=n.n(i),o=n(89),s=n.n(o),d=(n(463),n(36)),l=n(22),u=n(803),j=n(761),b=n(804),h=n(759),O=n(801),g=n(807),f=n(808),p=n(802),m=n(805),x=n(425),v=n.n(x),w=n(426),y=n.n(w),S=n(356),C=n.n(S),E=n(134),_=n(12),N=n.n(_),L=n(231),T=n(210),k=n(213),I=n(444);function D(e){var t=new URL(window.location.href),n=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BACKEND_PORT,r=n?t.origin.replace(t.port,n):t.origin;return"".concat(r).concat(e)}function R(e){return H.apply(this,arguments)}function H(){return(H=Object(L.a)(N.a.mark((function e(t){var n,r,a,i,c,o,s,d=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.length>1&&void 0!==d[1]?d[1]:{},r=n.body,a=Object(I.a)(n,["body"]),i={"Content-Type":"application/json"},c=Object(k.a)(Object(k.a)({method:r?"POST":"GET"},a),{},{headers:Object(k.a)(Object(k.a)({},i),a.headers)}),r&&(c.body=JSON.stringify(r)),e.prev=4,e.next=7,window.fetch(t,c);case 7:return s=e.sent,e.next=10,s.json();case 10:if(o=e.sent,!s.ok){e.next=13;break}return e.abrupt("return",o);case 13:throw new Error(s.statusText);case 16:return e.prev=16,e.t0=e.catch(4),e.abrupt("return",Promise.reject(e.t0.message?e.t0.message:o));case 19:case"end":return e.stop()}}),e,null,[[4,16]])})))).apply(this,arguments)}R.get=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return R(e,Object(k.a)(Object(k.a)({},t),{},{method:"GET"}))},R.post=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return R(e,Object(k.a)(Object(k.a)({},n),{},{body:t}))};var W=Object(T.b)("editor/fetchContent",function(){var e=Object(L.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.post(D("/script"),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),z=Object(T.b)("dag/fetchDAG",function(){var e=Object(L.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.post(D("/lineage"),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),P=Object(T.c)({name:"editor",initialState:{file:"",content:"",contentComposed:"",editable:!1,editorStatus:"idle",editorError:null,dagContent:[],dagVerbose:"",dagStatus:"idle",dagError:null},reducers:{setContentComposed:function(e,t){e.contentComposed=t.payload},setEditable:function(e,t){e.editable=t.payload},setFile:function(e,t){e.file=t.payload}},extraReducers:(r={},Object(d.a)(r,W.pending,(function(e){e.editorStatus="loading"})),Object(d.a)(r,W.fulfilled,(function(e,t){e.editorStatus="succeeded",e.content=t.payload.content})),Object(d.a)(r,W.rejected,(function(e,t){e.editorStatus="failed",e.editorError=t.error.message})),Object(d.a)(r,z.pending,(function(e){e.dagStatus="loading"})),Object(d.a)(r,z.fulfilled,(function(e,t){e.dagStatus="succeeded",e.dagContent=t.payload.dag,e.dagVerbose=t.payload.verbose})),Object(d.a)(r,z.rejected,(function(e,t){e.dagStatus="failed",e.dagError=t.error.message})),r)}),V=function(e){return e.editor},M=P.actions,B=M.setContentComposed,Q=M.setEditable,F=M.setFile,A=P.reducer,G=n(790),q=n(791);function U(e){return Object(a.jsx)(u.a,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:e.minHeight,children:Object(a.jsx)(G.a,{in:!0,style:{transitionDelay:"500ms"},unmountOnExit:!0,children:Object(a.jsx)(q.a,{})})})}var K=n(431),Z=n.n(K);function J(e){return Object(a.jsx)(u.a,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:e.minHeight,children:Object(a.jsxs)("span",{children:[Object(a.jsx)(Z.a,{color:"primary",fontSize:"large"}),Object(a.jsx)("p",{children:e.message})]})})}var Y=n(809),X=n(810),$=n(793),ee=n(794),te=n(433),ne=n.n(te),re=n(434),ae=n.n(re),ie=n(435),ce=n.n(ie),oe=n(436),se=n.n(oe);C.a.use(y.a);var de=Object($.a)((function(e){return{speedDial:{position:"absolute","&.MuiSpeedDial-directionLeft":{bottom:e.spacing(5),right:e.spacing(2)}}}}));function le(e){var t=de(),n=Object(E.c)(V),r=c.a.useState(!1),o=Object(l.a)(r,2),s=o[0],d=o[1],u=Object(i.useRef)(null);if("loading"===n.dagStatus)return Object(a.jsx)(U,{minHeight:e.height});if("failed"===n.dagStatus)return Object(a.jsx)(J,{minHeight:e.height,message:n.dagError});var j={width:e.width,height:e.height};return Object(a.jsxs)("div",{children:[Object(a.jsx)(v.a,{elements:n.dagContent,stylesheet:[{selector:"node",style:{height:10,width:10,content:"data(id)","text-valign":"top","text-halign":"right","font-size":10,color:"#35393e","background-color":"#3499d9","border-color":"#000","border-width":1,"border-opacity":.8}},{selector:"edge",style:{width:1,"line-color":"#9ab5c7","target-arrow-color":"#9ab5c7","target-arrow-shape":"triangle","arrow-scale":.8,"curve-style":"bezier"}}],style:j,layout:{name:"dagre",rankDir:"LR",rankSep:200},zoom:1,minZoom:.5,maxZoom:2,wheelSensitivity:.2,ref:u}),Object(a.jsxs)(Y.a,{ariaLabel:"SpeedDial example",className:t.speedDial,hidden:!1,icon:Object(a.jsx)(X.a,{}),onClose:function(){return d(!1)},onOpen:function(){return d(!0)},open:s,direction:"left",FabProps:{size:"small"},children:[Object(a.jsx)(ee.a,{title:"Save",icon:Object(a.jsx)(ne.a,{}),onClick:function(){if(u.current){var e=u.current._cy,t=document.createElement("a");t.download="".concat(n.file,".jpg"),t.href=e.jpg({full:!0,quality:1}),t.click(),d(!1)}}}),Object(a.jsx)(ee.a,{title:"Zoom In",icon:Object(a.jsx)(ae.a,{}),onClick:function(){u.current._cy.zoom(u.current._cy.zoom()+.1)}}),Object(a.jsx)(ee.a,{title:"Auto Fit",icon:Object(a.jsx)(ce.a,{}),onClick:function(){u.current._cy.fit()}}),Object(a.jsx)(ee.a,{title:"Zoom Out",icon:Object(a.jsx)(se.a,{}),onClick:function(){u.current._cy.zoom(u.current._cy.zoom()-.1)}})]})]})}var ue=n(332),je=n(110);function be(e){var t=Object(E.b)(),n=Object(E.c)(V),r=new URLSearchParams(Object(je.e)().search),c=Object(je.d)();Object(i.useEffect)((function(){var e=r.get("e");if(null!==e)t(B(e)),c.push("/");else{var a=r.get("f");n.file!==a&&(t(F(a)),null===a?(t(Q(!0)),t(z({e:n.contentComposed}))):(t(Q(!1)),t(W({f:a})),t(z({f:a}))))}}));if("loading"===n.editorStatus)return Object(a.jsx)(U,{minHeight:e.height});if("failed"===n.editorStatus)return Object(a.jsx)(J,{minHeight:e.height,message:n.editorError});var o={minimap:{enabled:!1},readOnly:!n.editable,wordWrap:"on",automaticLayout:!0};return Object(a.jsx)(ue.a,{width:e.width,height:e.height,language:"sql",value:n.editable?n.contentComposed:n.content,options:o,editorDidMount:function(e,n){e.onDidBlurEditorText((function(){e.getOption(75)||(t(B(e.getValue())),t(z({e:e.getValue()})))}))}})}var he,Oe=n(798),ge=n(799),fe=n(800),pe=n(442),me=n.n(pe),xe=n(443),ve=n.n(xe),we=n(758),ye=n(441),Se=n.n(ye),Ce=n(45),Ee=function(){var e=Object(L.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.post(D("/directory"),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_e=Object(T.b)("directory/fetchDirectory",Ee),Ne=Object(T.c)({name:"directory",initialState:{content:{},status:"idle",error:null,openNonSQLWarning:!1},reducers:{setOpenNonSQLWarning:function(e,t){e.openNonSQLWarning=t.payload}},extraReducers:(he={},Object(d.a)(he,_e.pending,(function(e){e.status="loading"})),Object(d.a)(he,_e.fulfilled,(function(e,t){e.status="succeeded",e.content=t.payload})),Object(d.a)(he,_e.rejected,(function(e,t){e.status="failed",e.error=t.error.message})),he)}),Le=function(e){return e.directory},Te=Ne.actions.setOpenNonSQLWarning,ke=Ne.reducer,Ie=n(806),De=n(797),Re=n(811),He=n(437),We=n.n(He),ze=n(438),Pe=n.n(ze),Ve=n(439),Me=n.n(Ve),Be=n(440),Qe=n.n(Be),Fe=Object($.a)((function(e){return{"@global":{".MuiTreeItem-root.Mui-selected > .MuiTreeItem-content .MuiTreeItem-label":{backgroundColor:"white"}},directory:{marginLeft:e.spacing(.2)},labelRoot:{display:"flex",alignItems:"center",padding:e.spacing(.1,0)},labelIcon:{marginRight:e.spacing(.2)},labelText:{fontWeight:"inherit",flexGrow:1}}}));function Ae(e){var t=Fe(),n=Object(je.d)(),r=Object(E.b)(),o=Object(E.c)(Le),s=c.a.useState(null),d=Object(l.a)(s,2),u=d[0],j=d[1],b=c.a.useState([]),h=Object(l.a)(b,2),O=h[0],g=h[1];Object(i.useEffect)((function(){var t;e.is_root&&(j((null!==(t=o.content.children)&&void 0!==t?t:[]).map((function(e){return Object(a.jsx)(Ae,{id:e.id,name:e.name,is_dir:e.is_dir,is_root:!1})}))),g([e.id]))}),[o.content.children,e.id,e.is_root]);return Object(a.jsx)(De.a,{className:t.directory,defaultCollapseIcon:Object(a.jsx)(We.a,{}),defaultExpandIcon:Object(a.jsx)(Pe.a,{}),expanded:O,onNodeSelect:function(){e.is_dir||(e.name.endsWith(".sql")?n.push("/?f=".concat(e.id)):r(Te(!0)))},onNodeToggle:function(e,t){var n=t.filter((function(e){return!O.includes(e)}));if(g(t),n[0]){var r=n[0];Ee({d:r}).then((function(e){return j(e.children.map((function(e){return Object(a.jsx)(Ae,{id:e.id,name:e.name,is_dir:e.is_dir,is_root:!1})})))}))}},children:Object(a.jsx)(Re.a,{nodeId:e.id,label:Object(a.jsxs)("div",{className:t.labelRoot,children:[e.is_dir?Object(a.jsx)(Me.a,{color:"action",className:t.labelIcon}):Object(a.jsx)(Qe.a,{color:"action",className:t.labelIcon}),Object(a.jsx)(we.a,{variant:"body2",className:t.labelText,children:e.name})]}),children:e.is_dir&&(u||[Object(a.jsx)("div",{},"stub")])},e.id)})}function Ge(e){var t=Object(E.b)(),n=Object(E.c)(Le);return Object(i.useEffect)((function(){if("idle"===n.status){var e=new URL(window.location.href);t(_e(Object.fromEntries(e.searchParams)))}})),"loading"===n.status?Object(a.jsx)(U,{minHeight:e.height}):"failed"===n.status?Object(a.jsx)(J,{minHeight:e.height,message:n.error}):Object(a.jsxs)("div",{children:[Object(a.jsx)(Ae,{id:n.content.id,name:n.content.name,is_dir:!0,is_root:!0}),Object(a.jsx)(Ie.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:n.openNonSQLWarning,autoHideDuration:1e3,onClose:function(){t(Te(!1))},message:"Non SQL File Is Not Supported"})]})}var qe=n(272);function Ue(e){var t=Object(E.c)(V);if("loading"===t.dagStatus)return Object(a.jsx)(U,{minHeight:e.height});if("failed"===t.dagStatus)return Object(a.jsx)(J,{minHeight:e.height,message:t.dagError});return Object(a.jsx)(ue.a,{width:e.width,height:e.height,value:t.dagVerbose,options:{minimap:{enabled:!1},readOnly:!0,wordWrap:"on",automaticLayout:!0}})}var Ke=Object($.a)((function(e){return{appBar:{flexGrow:1,zIndex:e.zIndex.drawer+1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},content:{padding:e.spacing(.5),marginTop:e.spacing(6),float:"right"},hide:{display:"none"},drawerPaper:{width:function(e){return e.drawerWidth+"vw"}},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},dragger:{width:"5px",cursor:"ew-resize",position:"absolute",top:0,bottom:0,left:function(e){return e.drawerWidth+"vw"},backgroundColor:"#d7d7d7"}}})),Ze=null;function Je(){var e=Object(E.c)(V),t=c.a.useState("dag"),n=Object(l.a)(t,2),r=n[0],o=n[1],s=c.a.useState(!0),x=Object(l.a)(s,2),v=x[0],w=x[1],y=c.a.useState(18),S=Object(l.a)(y,2),C=S[0],_=S[1],N=Ke({drawerWidth:C}),L="90vh",T=Object(i.useMemo)((function(){return(v?99.5-C:99.5)+"vw"}),[v,C]),k=function(e){if(Ze){var t=100*e.clientX/window.innerWidth;t>10&&t<50&&_(t)}},I=function e(){Ze&&(Ze=!1,document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",e))};return Object(a.jsx)(qe.a,{children:Object(a.jsxs)("div",{children:[Object(a.jsxs)(u.a,{children:[Object(a.jsx)(Oe.a,{position:"fixed",className:N.appBar,children:Object(a.jsxs)(ge.a,{variant:"dense",children:[Object(a.jsx)(fe.a,{edge:"start",className:N.menuButton,color:"inherit","aria-label":"menu",onClick:function(){w(!v)},children:v?Object(a.jsx)(Se.a,{}):Object(a.jsx)(me.a,{})}),Object(a.jsx)(we.a,{variant:"h6",className:N.title,children:"SQLLineage"}),e.editable?Object(a.jsx)(j.a,{title:"Visualize Lineage By Filling In Your Own SQL",arrow:!0,children:Object(a.jsx)("div",{children:"Composing Mode"})}):Object(a.jsx)(qe.b,{to:"/",style:{color:"white"},children:Object(a.jsx)(j.a,{title:"Enter Composing Mode to Visualize Your Own SQL",arrow:!0,children:Object(a.jsx)(fe.a,{color:"inherit",onClick:function(){o("script"),w(!1)},children:Object(a.jsx)(ve.a,{})})})})]})}),Object(a.jsx)(b.a,{variant:"persistent",open:v,classes:{paper:N.drawerPaper},children:Object(a.jsx)(u.a,{className:N.content,children:Object(a.jsx)(Ge,{})})})]}),Object(a.jsx)("div",{id:"dragger",onMouseDown:function(e){e.stopPropagation(),e.preventDefault(),document.addEventListener("mousemove",k),document.addEventListener("mouseup",I),Ze=!0},className:N.dragger}),Object(a.jsxs)("main",{className:Object(Ce.a)(N.content,Object(d.a)({},N.contentShift,v)),children:[Object(a.jsxs)(h.a,{elevation:"24",style:{height:L,width:T},children:[Object(a.jsx)(u.a,{className:"dag"===r?"":N.hide,children:Object(a.jsx)(le,{height:L,width:T})}),Object(a.jsx)(u.a,{className:"text"===r?"":N.hide,children:Object(a.jsx)(Ue,{height:L,width:T})}),Object(a.jsx)(u.a,{className:"script"===r?"":N.hide,children:Object(a.jsx)(be,{height:L,width:T})})]}),Object(a.jsx)(O.a,{container:!0,justify:"center",children:Object(a.jsx)(g.a,{component:"fieldset",children:Object(a.jsxs)(f.a,{row:!0,"aria-label":"position",name:"position",defaultValue:"dag",value:r,onChange:function(e){return o(e.target.value)},children:[Object(a.jsx)(p.a,{value:"dag",control:Object(a.jsx)(m.a,{color:"primary"}),label:"Lineage View"}),Object(a.jsx)(p.a,{value:"text",control:Object(a.jsx)(m.a,{color:"primary"}),label:"Text View"}),Object(a.jsx)(p.a,{value:"script",control:Object(a.jsx)(m.a,{color:"primary"}),label:"Script View"})]})})})]})]})})}var Ye=Object(T.a)({reducer:{directory:ke,editor:A}});s.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(E.a,{store:Ye,children:Object(a.jsx)(Je,{})})}),document.getElementById("root"))}},[[739,1,2]]]);
//# sourceMappingURL=main.a36a99e0.chunk.js.map